<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./h_files/filelist.xml">
<link rel=Edit-Time-Data href="./h_files/editdata.mso">
<link rel=OLE-Object-Data href="./h_files/oledata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Problem H: Millennium Ceremony</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Rujia Liu</o:Author>
  <o:LastAuthor>Shahriar Manzoor</o:LastAuthor>
  <o:Revision>8</o:Revision>
  <o:TotalTime>119</o:TotalTime>
  <o:LastPrinted>2002-12-27T12:00:00Z</o:LastPrinted>
  <o:Created>2004-02-14T07:30:00Z</o:Created>
  <o:LastSaved>2004-02-20T10:04:00Z</o:LastSaved>
  <o:Pages>3</o:Pages>
  <o:Words>815</o:Words>
  <o:Characters>4648</o:Characters>
  <o:Company>Tsinghua Univ.</o:Company>
  <o:Lines>38</o:Lines>
  <o:Paragraphs>9</o:Paragraphs>
  <o:CharactersWithSpaces>5708</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:View>Print</w:View>
  <w:Zoom>BestFit</w:Zoom>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>0</w:DisplayVerticalDrawingGridEvery>
  <w:UseMarginsForDrawingGridOrigin/>
  <w:Compatibility>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
   <w:UseFELayout/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Courier;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:7 0 0 0 19 0;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:\5B8B\4F53;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:SimHei;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-alt:\9ED1\4F53;
	mso-font-charset:134;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 135135232 16 0 262144 0;}
@font-face
	{font-family:"\@SimSun";
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:"\@SimHei";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:134;
	mso-generic-font-family:modern;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 135135232 16 0 262144 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:SimSun;
	color:black;}
h1
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;
	mso-font-kerning:0pt;
	font-weight:normal;
	font-style:italic;}
h2
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:widow-orphan;
	mso-outline-level:2;
	tab-stops:143.25pt;
	font-size:18.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
h3
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:14.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	color:windowtext;
	mso-font-kerning:14.0pt;
	mso-fareast-language:ZH-CN;
	font-weight:normal;}
h5
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:5;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	color:black;
	font-weight:bold;}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:SimSun;
	color:windowtext;
	font-weight:bold;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	font-size:18.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:SimSun;
	color:black;
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:SimSun;
	color:windowtext;}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	font-size:24.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:SimSun;
	color:black;
	font-weight:bold;}
p.MsoBodyText2, li.MsoBodyText2, div.MsoBodyText2
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:SimSun;
	color:black;
	mso-bidi-font-weight:bold;}
p.MsoBodyText3, li.MsoBodyText3, div.MsoBodyText3
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:SimSun;
	color:black;}
a:link, span.MsoHyperlink
	{color:#6633CC;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
em
	{mso-bidi-font-style:normal;}
p
	{margin-right:0in;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:SimSun;
	color:black;}
pre
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Courier New";
	color:windowtext;}
p.Preformatted, li.Preformatted, div.Preformatted
	{mso-style-name:Preformatted;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:none;
	tab-stops:0in 47.95pt 95.9pt 143.85pt 191.8pt 239.75pt 287.7pt 335.65pt 383.6pt 431.55pt 479.5pt;
	layout-grid-mode:char;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:SimSun;
	mso-bidi-font-family:"Times New Roman";
	color:windowtext;}
p.IOSample, li.IOSample, div.IOSample
	{mso-style-name:IOSample;
	mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:Courier;
	mso-fareast-font-family:SimSun;
	mso-bidi-font-family:"Times New Roman";
	color:windowtext;
	mso-fareast-language:ZH-CN;}
p.a, li.a, div.a
	{mso-style-name:\8868\680F\540D;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	line-height:14.0pt;
	mso-pagination:none;
	layout-grid-mode:char;
	mso-layout-grid-align:none;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Arial;
	mso-fareast-font-family:SimHei;
	mso-bidi-font-family:"Times New Roman";
	color:windowtext;
	mso-fareast-language:ZH-CN;}
p.a0, li.a0, div.a0
	{mso-style-name:\8868\6587;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:14.0pt;
	mso-pagination:none;
	layout-grid-mode:char;
	mso-layout-grid-align:none;
	font-size:9.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:SimSun;
	color:windowtext;
	mso-fareast-language:ZH-CN;}
span.StyleArial16pt
	{mso-style-name:"Style Arial 16 pt";
	mso-ansi-font-size:16.0pt;
	mso-ascii-font-family:Arial;
	mso-hansi-font-family:Arial;
	mso-bidi-font-family:Arial;
	font-weight:bold;}
@page Section1
	{size:8.5in 11.0in;
	margin:.8in .8in .8in .8in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1030">
  <o:colormru v:ext="edit" colors="#602000"/>
 </o:shapedefaults></xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US link="#6633cc" vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<h1 align=center style='text-align:center;tab-stops:4.0in'><b><span
style='font-size:28.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;font-style:
normal'>Problem H</span></b><b><span style='font-size:28.0pt;mso-bidi-font-size:
10.0pt;font-family:Arial;mso-fareast-language:ZH-CN;font-style:normal'><o:p></o:p></span></b></h1>

<h2 align=center style='text-align:center'><span style='font-size:20.0pt;
mso-bidi-font-size:10.0pt;font-family:Arial;mso-fareast-language:ZH-CN'>Millennium
Ceremony<o:p></o:p></span></h2>

<h3><b><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt'>Input:</span></b><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt'> Standard Input<o:p></o:p></span></h3>

<p class=MsoNormal align=center style='text-align:center'><b><span
style='font-family:Arial;mso-fareast-language:ZH-CN'>Output:</span></b><span
style='font-family:Arial;mso-fareast-language:ZH-CN'> Standard Output</span><span
style='font-family:Arial;mso-bidi-font-weight:bold'> <o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center'><b style='mso-bidi-font-weight:
normal'><span style='font-family:Arial'>Time Limit: </span></b><span
style='font-family:Arial;mso-bidi-font-weight:bold'>2 Seconds<o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center'><b style='mso-bidi-font-weight:
normal'><span style='mso-bidi-font-size:12.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'>On an ancient
island, people are holding a Millennium Ceremony in a beautiful palace. The
palace has <b style='mso-bidi-font-weight:normal'>n</b> normal layers; each is in
the shape of a perfect circle. Layers are numbered <b style='mso-bidi-font-weight:
normal'>1</b>, <b style='mso-bidi-font-weight:normal'>2</b>, <b
style='mso-bidi-font-weight:normal'>3</b> ... <b style='mso-bidi-font-weight:
normal'>n</b> from bottom to top. There are exactly <b style='mso-bidi-font-weight:
normal'>m</b>(<b style='mso-bidi-font-weight:normal'>m </b>is even) stelae on
each circle, which divide the circle into <b style='mso-bidi-font-weight:normal'>m</b>
identical parts. One each layer, the stelae are numbered <b style='mso-bidi-font-weight:
normal'>1</b>, <b style='mso-bidi-font-weight:normal'>2</b>, <b
style='mso-bidi-font-weight:normal'>3</b> ... <b style='mso-bidi-font-weight:
normal'>m</b> in counter-clockwise order. Each stele has exactly two neighbors.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'>The Grand Altar is
at the center of the bottom (you may call it layer <b style='mso-bidi-font-weight:
normal'>0</b>, it is below layer <b style='mso-bidi-font-weight:normal'>1</b>),
which is the starting point of the whole ceremony. The Holy Torch is hanging at
the ceiling of the palace(you may call it layer <b style='mso-bidi-font-weight:
normal'>n</b>+<b style='mso-bidi-font-weight:normal'>1</b>, it is above layer <b
style='mso-bidi-font-weight:normal'>n</b>). In these two special layers(layer <b
style='mso-bidi-font-weight:normal'>0</b> and layer <b style='mso-bidi-font-weight:
normal'>n</b>+<b style='mso-bidi-font-weight:normal'>1</b>), there are no
stelae.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'>On any middle
layer <b style='mso-bidi-font-weight:normal'>i</b> (i.e <b style='mso-bidi-font-weight:
normal'>1 </b>&lt; <b style='mso-bidi-font-weight:normal'>i </b>&lt; <b
style='mso-bidi-font-weight:normal'>n</b>), each stele is tied with <b
style='mso-bidi-font-weight:normal'>2k</b>+<b style='mso-bidi-font-weight:normal'>2</b>
ropes. Two of them are tied on the two neighboring stelae on the same layer(one
rope each each neighbor), we call those <b style='mso-bidi-font-weight:normal'>2</b>
ropes 'intra-layer ropes'. Besides, <b style='mso-bidi-font-weight:normal'>k</b>
of them are tied with <b style='mso-bidi-font-weight:normal'>k</b> different
stelae on layer <b style='mso-bidi-font-weight:normal'>i</b>-<b
style='mso-bidi-font-weight:normal'>1</b>, while <b style='mso-bidi-font-weight:
normal'>k</b> of them are tied with <b style='mso-bidi-font-weight:normal'>k</b>
stelae on layer <b style='mso-bidi-font-weight:normal'>i</b>+<b
style='mso-bidi-font-weight:normal'>1</b>. These <b style='mso-bidi-font-weight:
normal'>2k</b> ropes are called 'inter-layer ropes'. Intra-layer ropes and
inter-layer ropes are shown in picture (a). To make the palace look more
beautiful, the number of two ending stelae of an inter-layer rope must have the
same parity (i.e both odd or both even) and <b style='mso-bidi-font-weight:
normal'>k</b> is always odd.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'>Every stele on
layer <b style='mso-bidi-font-weight:normal'>1</b> is connected to The Grand
Altar with a rope, these ropes are called 'Altar-ropes',<span
style="mso-spacerun: yes">  </span>while every stele on layer <b
style='mso-bidi-font-weight:normal'>n</b> is connected to The Holy Torch with a
rope, these ropes are called 'Torch ropes'. These ropes are shown in picture
(b) and (c). <o:p></o:p></span></p>

<center><img width=572 height=184
src="p10630.gif"></center>


<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'>You may have
calculated that there are (<b style='mso-bidi-font-weight:normal'>n</b>-<b
style='mso-bidi-font-weight:normal'>1</b>)*<b style='mso-bidi-font-weight:normal'>m</b>*<b
style='mso-bidi-font-weight:normal'>k</b> inter-layer ropes, <b
style='mso-bidi-font-weight:normal'>n</b>*<b style='mso-bidi-font-weight:normal'>m</b>
intra-layer ropes, <b style='mso-bidi-font-weight:normal'>m</b> Altar-ropes and
<b style='mso-bidi-font-weight:normal'>m</b> Torch ropes. Altogether, there are
<b style='mso-bidi-font-weight:normal'>m</b>*(<b style='mso-bidi-font-weight:
normal'>n</b>*<b style='mso-bidi-font-weight:normal'>k</b>-<b style='mso-bidi-font-weight:
normal'>k</b>+<b style='mso-bidi-font-weight:normal'>n</b>+<b style='mso-bidi-font-weight:
normal'>2</b>) ropes in total.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'>At the beginning
of the ceremony, two heroes Chris and Chirt must light up The Holy Torch.
According to the custom there, they should move from The Grand Altar to The
Holy Torch, then back to The Grand Altar. They can move along a rope from one
place(Altar, Torch or a stele) to another, but each rope should be passed by
exactly twice: one for each person. Chiris goes first, after he comes back,
Chrit goes.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'>The ropes are
magic. They are transparent before Chris starts his trip, but if someone is
reaching a stele or The Holy Torch for his first time, the rope he has just
passed by changes its color! The color it's changing to depends on the person
and the type of the rope, shown below.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<div align=center>

<table border=1 cellspacing=0 cellpadding=0 style='margin-left:5.5pt;
 border-collapse:collapse;border:none;mso-border-top-alt:solid windowtext 1.0pt;
 mso-border-bottom-alt:solid windowtext 1.0pt;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width=182 valign=top style='width:136.6pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  background:#DFDFDF;mso-shading:windowtext;mso-pattern:gray-125 auto;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=a>Person</p>
  </td>
  <td width=182 valign=top style='width:136.65pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-left-alt:solid windowtext .5pt;background:#DFDFDF;mso-shading:
  windowtext;mso-pattern:gray-125 auto;padding:0in 5.4pt 0in 5.4pt'>
  <p class=a>intra-layer ropes</p>
  </td>
  <td width=182 valign=top style='width:136.65pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext .5pt;border-right:none;
  mso-border-left-alt:solid windowtext .5pt;background:#DFDFDF;mso-shading:
  windowtext;mso-pattern:gray-125 auto;padding:0in 5.4pt 0in 5.4pt'>
  <p class=a>other ropes</p>
  </td>
 </tr>
 <tr>
  <td width=182 style='width:136.6pt;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=a0 align=center style='text-align:center'>Chris</p>
  </td>
  <td width=182 style='width:136.65pt;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=a0 align=center style='text-align:center'>Golden</p>
  </td>
  <td width=182 style='width:136.65pt;border:none;border-bottom:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=a0 align=center style='text-align:center'>Dark Grey</p>
  </td>
 </tr>
 <tr>
  <td width=182 style='width:136.6pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=a0 align=center style='text-align:center'>Chrit</p>
  </td>
  <td width=182 style='width:136.65pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=a0 align=center style='text-align:center'>Silver</p>
  </td>
  <td width=182 style='width:136.65pt;border:none;border-bottom:solid windowtext 1.0pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=a0 align=center style='text-align:center'>Light Grey</p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'>Note that Chrit
should never make a color-changed rope change its color again, so if he is
facing a stele or The Holy Torch which he has never been to, he can go there if
and only if the rope he will pass by is still crystal-transparent.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'>If you understand
all the things above, you will know that after Chrit's trip, golden ropes and
dark-grey ropes should be <b style='mso-bidi-font-weight:normal'>n</b>*<b
style='mso-bidi-font-weight:normal'>m</b>+<b style='mso-bidi-font-weight:normal'>1</b>
in total, while the silver ropes and light-grey ropes are also <b
style='mso-bidi-font-weight:normal'>n</b>*<b style='mso-bidi-font-weight:normal'>m</b>+<b
style='mso-bidi-font-weight:normal'>1</b>, because for each of the <b
style='mso-bidi-font-weight:normal'>n</b>*<b style='mso-bidi-font-weight:normal'>m</b>
stelae, and for The Holy Torch, there is exactly one color-changed rope changed
color when someone reached the stelae or The Holy Torch for his first time.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'>Now, Here comes
the ultimate mission for Chris and Chrit! When they finished their trip, each
layer should be decorated by alternated golden-silver ropes! (i.e
golden-&gt;silver-&gt;golden-&gt;silver-&gt;golden-&gt;silver...) No
intra-layer ropes may remain transparent, and no two neighboring intra-layer
ropes should be in the same color! If this is done, imagine how splendid the
palace looks!<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'>Help Chris and
Chrit to make the palace surrounded by golden-silver rings!<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><b
style='mso-bidi-font-weight:normal'><span style='font-size:18.0pt'>Input</span><o:p></o:p></b></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><span
style='color:windowtext'>The first line contains the number of tests <b
style='mso-bidi-font-weight:normal'>t(1&lt;=t&lt;=15)</b>. Each case contains </span><span
style='color:windowtext;mso-fareast-language:ZH-CN'>several</span><span
style='color:windowtext'> lines. The first line contains </span><span
style='color:windowtext;mso-fareast-language:ZH-CN'>three</span><span
style='color:windowtext'> integer</span><span style='color:windowtext;
mso-fareast-language:ZH-CN'>s</span><span style='color:windowtext'> <b
style='mso-bidi-font-weight:normal'>n</b></span><b style='mso-bidi-font-weight:
normal'><span style='color:windowtext;mso-fareast-language:ZH-CN'>, m, k</span></b><b
style='mso-bidi-font-weight:normal'><span style='color:windowtext'>(1</span></b><span
style='color:windowtext'>&lt;=<b style='mso-bidi-font-weight:normal'>n</b></span><span
style='color:windowtext;mso-fareast-language:ZH-CN'>,<b style='mso-bidi-font-weight:
normal'> m</b></span><span style='color:windowtext'>&lt;=</span><b
style='mso-bidi-font-weight:normal'><span style='color:windowtext;mso-fareast-language:
ZH-CN'>5</span></b><b style='mso-bidi-font-weight:normal'><span
style='color:windowtext'>0</span></b><b style='mso-bidi-font-weight:normal'><span
style='color:windowtext;mso-fareast-language:ZH-CN'>, 1</span></b><span
style='color:windowtext;mso-fareast-language:ZH-CN'>&lt;=<b style='mso-bidi-font-weight:
normal'>k</b>&lt;=<b style='mso-bidi-font-weight:normal'>9</b>, <b
style='mso-bidi-font-weight:normal'>m</b> is even, <b style='mso-bidi-font-weight:
normal'>k</b> is odd</span><b style='mso-bidi-font-weight:normal'><span
style='color:windowtext'>)</span></b><span style='color:windowtext;mso-fareast-language:
ZH-CN'>.</span><span style='color:windowtext'> </span><span style='color:windowtext;
mso-fareast-language:ZH-CN'>There are <b style='mso-bidi-font-weight:normal'>n</b>-<b
style='mso-bidi-font-weight:normal'>1</b> blocks follow. The <b
style='mso-bidi-font-weight:normal'>i</b>-th block(<b style='mso-bidi-font-weight:
normal'>1</b>&lt;=<b style='mso-bidi-font-weight:normal'>i</b>&lt;=<b
style='mso-bidi-font-weight:normal'>n</b>-<b style='mso-bidi-font-weight:normal'>1</b>)
describes the inter-layer ropes between layer <b style='mso-bidi-font-weight:
normal'>i</b> and layer <b style='mso-bidi-font-weight:normal'>i</b>+<b
style='mso-bidi-font-weight:normal'>1</b>. The block contains <b
style='mso-bidi-font-weight:normal'>m</b> lines, the <b style='mso-bidi-font-weight:
normal'>j</b>-th line(<b style='mso-bidi-font-weight:normal'>1</b>&lt;=<b
style='mso-bidi-font-weight:normal'>j</b>&lt;=<b style='mso-bidi-font-weight:
normal'>m</b>) contains <b style='mso-bidi-font-weight:normal'>k</b> integers,
indicating the numbers of <b style='mso-bidi-font-weight:normal'>k</b> stelae
on layer <b style='mso-bidi-font-weight:normal'>i</b>+<b style='mso-bidi-font-weight:
normal'>1</b> that are connected with <b style='mso-bidi-font-weight:normal'>j</b>-th
stele on layer <b style='mso-bidi-font-weight:normal'>i</b>.</span><span
style='color:windowtext'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><b
style='mso-bidi-font-weight:normal'><span style='mso-bidi-font-size:18.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph'><b
style='mso-bidi-font-weight:normal'><span style='font-size:18.0pt'>Output<o:p></o:p></span></b></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph;
mso-layout-grid-align:none;text-autospace:none'><span style='color:windowtext'>For
each test case, </span><span style='color:windowtext;mso-fareast-language:ZH-CN'>the
first line should be </span><span style='color:windowtext'>the case number and </span><span
style='color:windowtext;mso-fareast-language:ZH-CN'>your yes-no answer. If there
is an answer, print 'Yes', otherwise print 'No'. If the answer is 'Yes', print <b
style='mso-bidi-font-weight:normal'>2</b>*</span><b style='mso-bidi-font-weight:
normal'><span style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'>m</span></b><span
style='mso-bidi-font-size:12.0pt;mso-fareast-language:ZH-CN'>*(<b
style='mso-bidi-font-weight:normal'>n</b>*<b style='mso-bidi-font-weight:normal'>k</b>-<b
style='mso-bidi-font-weight:normal'>k</b>+<b style='mso-bidi-font-weight:normal'>n</b>+<b
style='mso-bidi-font-weight:normal'>2</b>) lines. The first <b
style='mso-bidi-font-weight:normal'>m</b>*(<b style='mso-bidi-font-weight:normal'>n</b>*<b
style='mso-bidi-font-weight:normal'>k</b>-<b style='mso-bidi-font-weight:normal'>k</b>+<b
style='mso-bidi-font-weight:normal'>n</b>+<b style='mso-bidi-font-weight:normal'>2</b>)
lines describe Chiris' route. The <b style='mso-bidi-font-weight:normal'>i</b>-th
line among them contains two integers (<b style='mso-bidi-font-weight:normal'>x</b>,
<b style='mso-bidi-font-weight:normal'>y</b>), indicating Chiris is at the <b
style='mso-bidi-font-weight:normal'>y</b>-th stele on layer <b
style='mso-bidi-font-weight:normal'>x</b> after he passed the <b
style='mso-bidi-font-weight:normal'>i</b>-th rope on his trip. <b
style='mso-bidi-font-weight:normal'>x</b> = <b style='mso-bidi-font-weight:
normal'>0</b> means The Grand Altar, while <b style='mso-bidi-font-weight:normal'>x</b>
= <b style='mso-bidi-font-weight:normal'>n</b>+<b style='mso-bidi-font-weight:
normal'>1</b> means The Holy Torch. The second <b style='mso-bidi-font-weight:
normal'>m</b>*(<b style='mso-bidi-font-weight:normal'>n</b>*<b
style='mso-bidi-font-weight:normal'>k</b>-<b style='mso-bidi-font-weight:normal'>k</b>+<b
style='mso-bidi-font-weight:normal'>n</b>+<b style='mso-bidi-font-weight:normal'>2</b>)
lines describe Chrit's route, the format is the same. If there are more than
one solution, any one is ok.</span><span style='color:windowtext;mso-fareast-language:
ZH-CN'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><span
style='font-size:10.0pt;font-family:"Courier New";color:windowtext'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1 align=left style='text-align:left'><b><span style='font-size:16.0pt;
mso-bidi-font-size:10.0pt;font-family:Arial;font-style:normal'>Sample
Input<span style="mso-spacerun: yes">                             </span>Output
for Sample Input<o:p></o:p></span></b></h1>

<table border=1 cellspacing=0 cellpadding=0 bgcolor="#cccccc" style='background:
 #CCCCCC;border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width=307 valign=top style='width:3.2in;border:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
  color:windowtext;mso-fareast-language:ZH-CN'>2<o:p></o:p></span></b></p>
  <p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
  color:windowtext;mso-fareast-language:ZH-CN'>2 4 1<o:p></o:p></span></b></p>
  <p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
  color:windowtext'>1</span></b><b><span style='font-size:11.0pt;mso-bidi-font-size:
  10.0pt;font-family:"Courier New";color:windowtext;mso-fareast-language:ZH-CN'><o:p></o:p></span></b></p>
  <p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
  color:windowtext;mso-fareast-language:ZH-CN'>2<o:p></o:p></span></b></p>
  <p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
  color:windowtext;mso-fareast-language:ZH-CN'>3<o:p></o:p></span></b></p>
  <p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
  color:windowtext;mso-fareast-language:ZH-CN'>4<o:p></o:p></span></b></p>
  <p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
  color:windowtext;mso-fareast-language:ZH-CN'>1 6 1</span></b><b><span
  style='font-size:11.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New";
  color:windowtext;mso-fareast-language:ZH-CN'><o:p></o:p></span></b></p>
  </td>
  <td width=309 valign=top style='width:231.85pt;border:solid windowtext .5pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='mso-pagination:none;mso-layout-grid-align:none;
  text-autospace:none'><b style='mso-bidi-font-weight:normal'><span lang=ZH-CN
  style='font-size:11.0pt;font-family:"Courier New";color:windowtext;
  mso-ansi-language:ZH-CN;mso-fareast-language:ZH-CN'>Case 1: Yes<o:p></o:p></span></b></p>
  <p class=MsoNormal style='mso-pagination:none;mso-layout-grid-align:none;
  text-autospace:none'><b style='mso-bidi-font-weight:normal'><span lang=ZH-CN
  style='font-size:11.0pt;font-family:"Courier New";color:windowtext;
  mso-ansi-language:ZH-CN;mso-fareast-language:ZH-CN'>1 2 1 3 0 0 1 4 1 1 1 2 2
  2 2 3<o:p></o:p></span></b></p>
  <p class=MsoNormal style='mso-pagination:none;mso-layout-grid-align:none;
  text-autospace:none'><b style='mso-bidi-font-weight:normal'><span lang=ZH-CN
  style='font-size:11.0pt;font-family:"Courier New";color:windowtext;
  mso-ansi-language:ZH-CN;mso-fareast-language:ZH-CN'>1 3 1 4 2 4 2 1 2 2 3 0 2
  3 2 4<o:p></o:p></span></b></p>
  <p class=MsoNormal style='mso-pagination:none;mso-layout-grid-align:none;
  text-autospace:none'><b style='mso-bidi-font-weight:normal'><span lang=ZH-CN
  style='font-size:11.0pt;font-family:"Courier New";color:windowtext;
  mso-ansi-language:ZH-CN;mso-fareast-language:ZH-CN'>3 0 2 1 1 1 0 0 1 3 1 4 0
  0 1 1<o:p></o:p></span></b></p>
  <p class=MsoNormal style='mso-pagination:none;mso-layout-grid-align:none;
  text-autospace:none'><b style='mso-bidi-font-weight:normal'><span lang=ZH-CN
  style='font-size:11.0pt;font-family:"Courier New";color:windowtext;
  mso-ansi-language:ZH-CN;mso-fareast-language:ZH-CN'>1 2 1 3 2 3 2 4 1 4 1 1 2
  1 3 0<o:p></o:p></span></b></p>
  <p class=MsoNormal style='mso-pagination:none;mso-layout-grid-align:none;
  text-autospace:none'><b style='mso-bidi-font-weight:normal'><span lang=ZH-CN
  style='font-size:11.0pt;font-family:"Courier New";color:windowtext;
  mso-ansi-language:ZH-CN;mso-fareast-language:ZH-CN'>2 4 2 1 2 2 2 3 3 0 2 2 1
  2 0 0<o:p></o:p></span></b></p>
  <p class=MsoNormal style='mso-pagination:none;mso-layout-grid-align:none;
  text-autospace:none'><b style='mso-bidi-font-weight:normal'><span lang=ZH-CN
  style='font-size:11.0pt;font-family:"Courier New";color:windowtext;
  mso-ansi-language:ZH-CN;mso-fareast-language:ZH-CN'>Case 2: Yes<o:p></o:p></span></b></p>
  <p class=MsoNormal style='mso-pagination:none;mso-layout-grid-align:none;
  text-autospace:none'><b style='mso-bidi-font-weight:normal'><span lang=ZH-CN
  style='font-size:11.0pt;font-family:"Courier New";color:windowtext;
  mso-ansi-language:ZH-CN;mso-fareast-language:ZH-CN'>1 4 1 5 0 0 1 2 1 3 0 0 1
  6 1 1<o:p></o:p></span></b></p>
  <p class=MsoNormal style='mso-pagination:none;mso-layout-grid-align:none;
  text-autospace:none'><b style='mso-bidi-font-weight:normal'><span lang=ZH-CN
  style='font-size:11.0pt;font-family:"Courier New";color:windowtext;
  mso-ansi-language:ZH-CN;mso-fareast-language:ZH-CN'>1 2 2 0 1 5 1 6 2 0 1 3 1
  4 2 0<o:p></o:p></span></b></p>
  <p class=MsoNormal style='mso-pagination:none;mso-layout-grid-align:none;
  text-autospace:none'><b style='mso-bidi-font-weight:normal'><span lang=ZH-CN
  style='font-size:11.0pt;font-family:"Courier New";color:windowtext;
  mso-ansi-language:ZH-CN;mso-fareast-language:ZH-CN'>1 1 0 0 1 5 1 6 0 0 1 3 1
  4 0 0<o:p></o:p></span></b></p>
  <p class=MsoNormal style='mso-pagination:none;mso-layout-grid-align:none;
  text-autospace:none'><b style='mso-bidi-font-weight:normal'><span lang=ZH-CN
  style='font-size:11.0pt;font-family:"Courier New";color:windowtext;
  mso-ansi-language:ZH-CN;mso-fareast-language:ZH-CN'>1 1 2 0 1 4 1 5 2 0 1 6 1
  1 1 2<o:p></o:p></span></b></p>
  <p class=MsoNormal style='mso-pagination:none;mso-layout-grid-align:none;
  text-autospace:none'><b style='mso-bidi-font-weight:normal'><span lang=ZH-CN
  style='font-size:11.0pt;font-family:"Courier New";color:windowtext;
  mso-ansi-language:ZH-CN;mso-fareast-language:ZH-CN'>1 3 2 0 1 2 0 0<o:p></o:p></span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN style='mso-ansi-language:EN;mso-fareast-language:
ZH-CN'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><i style='mso-bidi-font-style:normal'><u><span lang=EN
style='mso-ansi-language:EN;mso-fareast-language:ZH-CN'>Special note:</span></u></i><i
style='mso-bidi-font-style:normal'><span lang=EN style='mso-ansi-language:EN;
mso-fareast-language:ZH-CN'> The sample output is too long. We combine 8 lines into
one in the table above to reduce the length of the table, but keep in mind that
the real output should contain only two integers each line.<o:p></o:p></span></i></p>


<div class=MsoNormal align=center style='text-align:center'><span lang=EN
style='mso-ansi-language:EN'>

<hr size=2 width="100%" align=center>

</span></div>


<p class=MsoCaption style='tab-stops:.5in 45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><span
style='mso-bidi-font-size:10.0pt;font-family:Arial'>Problemsetter: Rujia Liu,
Member of Elite Problemsetters' Panel<o:p></o:p></span></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
style='font-family:Arial;mso-fareast-language:ZH-CN'>Problem Source: IOI2003
China Team Selective Contest</span></b><b style='mso-bidi-font-weight:normal'><span
style='font-family:Arial'><o:p></o:p></span></b></p>

</div>

</body>

</html>
