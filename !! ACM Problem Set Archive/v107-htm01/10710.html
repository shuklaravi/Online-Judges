<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./f_files/filelist.xml">
<link rel=Edit-Time-Data href="./f_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Problem F - Chinese Shuffle</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Shahriar Manzoor</o:Author>
  <o:LastAuthor>Shahriar Manzoor</o:LastAuthor>
  <o:Revision>15</o:Revision>
  <o:TotalTime>126</o:TotalTime>
  <o:Created>2004-07-21T23:52:00Z</o:Created>
  <o:LastSaved>2004-08-25T04:20:00Z</o:LastSaved>
  <o:Pages>3</o:Pages>
  <o:Words>805</o:Words>
  <o:Characters>4590</o:Characters>
  <o:Company>ACM/ICPC</o:Company>
  <o:Lines>38</o:Lines>
  <o:Paragraphs>9</o:Paragraphs>
  <o:CharactersWithSpaces>5636</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:View>Print</w:View>
  <w:Zoom>BestFit</w:Zoom>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Arial Unicode MS";
	mso-font-alt:Tahoma;
	mso-font-charset:128;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-1 -369098753 63 0 4129023 0;}
@font-face
	{font-family:"\@Arial Unicode MS";
	mso-font-charset:128;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-1 -369098753 63 0 4129023 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-outline-level:1;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Arial Unicode MS";
	color:black;
	mso-font-kerning:0pt;
	font-weight:normal;
	font-style:italic;}
h2
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:16.0pt;
	mso-bidi-font-size:18.0pt;
	font-family:Arial;
	font-weight:bold;}
h3
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:12.0pt;
	font-family:Arial;
	font-weight:bold;}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
p
	{font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
pre
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Courier New";}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in .8in 1.0in .8in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:1913537520;
	mso-list-type:hybrid;
	mso-list-template-ids:127295236 2028371024 -2014812108 553975262 -93454332 -101018034 -1528550944 -808698322 -140724798 -2132137928;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l1
	{mso-list-id:2010013072;
	mso-list-type:hybrid;
	mso-list-template-ids:1259112406 -1878219142 454615072 -276403080 -809706252 940591134 196514058 -681026430 1557435668 -1315773658;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1027"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<p class=MsoNormal align=center style='text-align:center'><b><span
style='font-size:28.0pt;mso-bidi-font-size:18.0pt;font-family:Arial'>Problem F</span></b><br>
<b><span style='font-size:20.0pt;mso-bidi-font-size:12.0pt;font-family:Arial'>Chinese
Shuffle</span></b><br>
<b><span style='font-family:Arial'>Input:</span></b><span style='font-family:
Arial'> standard input<br>
<b>Output:</b> standard output<br>
<b>Time Limit:</b> 1 second</span><br style='mso-special-character:line-break'>
<![if !supportLineBreakNewLine]><br style='mso-special-character:line-break'>
<![endif]></p>

<p style='text-align:justify'>Jimmy was a math student in Chicago in the
thirties of the last century. Being a student was tough those days (as it still
is), and he was always short of money. So he decided to moonlight at the casino
of his uncle. Well, casino is a big word; it was the upstairs room of a cafe,
and you had to know the guy at the back door to be alowed to enter at all.
Anyway, making profit was the main goal of his uncle, so Jimmy was expected to
do just that.<span style='mso-fareast-font-family:"Arial Unicode MS"'><o:p></o:p></span></p>

<p style='text-align:justify'>One day, sitting alone in his room, not knowing
where to start studying for his next exam, he took up a deck of playing cards
and began practicing his &quot;Perfect Shuffle&quot;. Let me explain what a
perfect shuffle is.<o:p></o:p></p>

<p style='text-align:justify'>In an ordinairy shuffle, the dealer splits the
deck in two roughly equal parts, takes one half in each hand and then releases
the cards alternating from his left and right hand onto a new pile on the
table. You probably know what I mean; when you try it yourself, the cards end
up all over the place. In Jimmy's perfect shuffle you start with N cards (N=52
for an ordinary deck). Take the top N/2 cards in your right hand (round down if
N is odd) and the remaining cards in your left. Now drop the bottom most card
from your left hand, cover it with the bottom most card from your right hand,
drop the next bottom most from your left hand, etc., alternating between left
and right until all the cards are in one pile again.<o:p></o:p></p>

<p style='text-align:justify'>Let's take 10 cards, numbered 1 to 10 from top to
bottom. After one shuffle the order becomes:<o:p></o:p></p>

<pre style='text-align:justify'>RIGHT: 1 2 3 4 5, LEFT: 6 7 8 9 10<span style="mso-spacerun: yes">  </span>-&gt; 1 6 2 7 3 8 4 9 5 10<o:p></o:p></pre>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify'>With 11 cards:<o:p></o:p></p>

<pre style='text-align:justify'>RIGHT: 1 2 3 4 5, LEFT: 6 7 8 9 10 11 -&gt; 6 1 7 2 8 3 9 4 10 5 11<o:p></o:p></pre>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify'>Jimmy practiced
his shuffle to perfection. There is of course a great benifit in being able to
do a perfect shuffle: once you know the order of the cards before the shuffle,
you can predict the order after the shuffle. Dealing at the Black Jack table,
he made his uncle very happy. But that's beside the point now. The thing Jimmy
noticed while he was practicing, was that only 8 out of all 52! different
orderings of a standard deck of cards could be attained by repeatedly applying
his shuffle. In other words: after 8 perfect shuffles the cards were in their
original order again. He started wondering what was so special about the number
8 and added a Joker to the deck. With this new deck of 53 cards he discovered
that he needed 52 perfect shuffles to return to the original ordering. A
completely different number. Now his mathematical curiosity was roused and he
started experimenting with different numbers of cards.<o:p></o:p></p>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify'>For example for
9 cards:<o:p></o:p></p>

<pre style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></pre><pre
style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></pre><pre
style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></pre><pre
style='text-align:justify'>original : 1 2 3 4 5 6 7 8 9<o:p></o:p></pre><pre
style='text-align:justify'>shuffle 1: 5 1 6 2 7 3 8 4 9<o:p></o:p></pre><pre
style='text-align:justify'>shuffle 2: 7 5 3 1 8 6 4 2 9<o:p></o:p></pre><pre
style='text-align:justify'>shuffle 3: 8 7 6 5 4 3 2 1 9<o:p></o:p></pre><pre
style='text-align:justify'>shuffle 4: 4 8 3 7 2 6 1 5 9<o:p></o:p></pre><pre
style='text-align:justify'>shuffle 5: 2 4 6 8 1 3 5 7 9<o:p></o:p></pre><pre
style='text-align:justify'>shuffle 6: 1 2 3 4 5 6 7 8 9<o:p></o:p></pre>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify'>Here are the
results for N=3 to 20:<o:p></o:p></p>

<pre style='text-align:justify'><span style="mso-spacerun: yes"> </span>3: 2 <span style="mso-spacerun: yes"> </span>shuffles<o:p></o:p></pre><pre
style='text-align:justify'> 4: 2<span style="mso-spacerun: yes">  </span>shuffles<o:p></o:p></pre><pre
style='text-align:justify'> 5: 4<span style="mso-spacerun: yes">  </span>shuffles<o:p></o:p></pre><pre
style='text-align:justify'> 6: 4<span style="mso-spacerun: yes">  </span>shuffles<o:p></o:p></pre><pre
style='text-align:justify'> 7: 3<span style="mso-spacerun: yes">  </span>shuffles<o:p></o:p></pre><pre
style='text-align:justify'> 8: 3<span style="mso-spacerun: yes">  </span>shuffles<o:p></o:p></pre><pre
style='text-align:justify'> 9: 6<span style="mso-spacerun: yes">  </span>shuffles<o:p></o:p></pre><pre
style='text-align:justify'>10: 6<span style="mso-spacerun: yes">  </span>shuffles<o:p></o:p></pre><pre
style='text-align:justify'>11: 10 shuffles<o:p></o:p></pre><pre
style='text-align:justify'>12: 10 shuffles<o:p></o:p></pre><pre
style='text-align:justify'>13: 12 shuffles<o:p></o:p></pre><pre
style='text-align:justify'>14: 12 shuffles<o:p></o:p></pre><pre
style='text-align:justify'>15: 4<span style="mso-spacerun: yes">  </span>shuffles<o:p></o:p></pre><pre
style='text-align:justify'>16: 4<span style="mso-spacerun: yes">  </span>shuffles<o:p></o:p></pre><pre
style='text-align:justify'>17: 8<span style="mso-spacerun: yes">  </span>shuffles<o:p></o:p></pre><pre
style='text-align:justify'>18: 8<span style="mso-spacerun: yes">  </span>shuffles<o:p></o:p></pre><pre
style='text-align:justify'>19: 18 shuffles<o:p></o:p></pre><pre
style='text-align:justify'>20: 18 shuffles<o:p></o:p></pre>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify'>Completing the
list up to 53 cards, he made some preliminary conclusions:<o:p></o:p></p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     text-align:justify;mso-list:l1 level1 lfo1;tab-stops:list .5in'>If N is
     even, the number of shuffles is equal to the number of shuffles for N-1; <o:p></o:p></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     text-align:justify;mso-list:l1 level1 lfo1;tab-stops:list .5in'>The
     maximum number of shuffles for N cards is N-1; <o:p></o:p></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     text-align:justify;mso-list:l1 level1 lfo1;tab-stops:list .5in'>The values
     of N for which this maximum is attained (up to 53) are: 3, 5, 11, 13, 19,
     29, 37 and 53. <o:p></o:p></li>
</ul>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify'>(For N=1 and N=2
the situation is doubtful; one can argue if so few cards are
&quot;shufflable&quot;.)<o:p></o:p></p>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify'>Of course he
recognised these numbers, as you probably do, but he felt that some were
missing. Notably 7, 17, 23, 31, 41, 43 and 47 had less than the maximum number
of shuffles. But for these numbers he discovered that the original order would
also be restored after N-1 shuffles. For instance it takes 8 shuffles to
restore the order of 17 cards, which means the order is also restored after 2 x
8 = 16 shuffles. Up to N=53, no other values than the mentioned ones have this
property. Jimmy had the impression that he was on to something big, but since
his hands can only hold a limited number of cards, he asks for your assistance
to calculate the result for bigger values of N. (There is this small issue of
time-warping the results back some 70 years, but that will be solved some other
time.)<o:p></o:p></p>

<p style='margin:0in;margin-bottom:.0001pt;text-align:justify'>Let's define a
Jimmy-number as:<o:p></o:p></p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     text-align:justify;mso-list:l0 level1 lfo2;tab-stops:list .5in'>take a
     deck of N playing cards in some predefined order; <o:p></o:p></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     text-align:justify;mso-list:l0 level1 lfo2;tab-stops:list .5in'>make N-1
     perfect shuffles, as defined above; <o:p></o:p></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     text-align:justify;mso-list:l0 level1 lfo2;tab-stops:list .5in'>if the
     cards are in their original order, N is a Jimmy-number; <o:p></o:p></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     text-align:justify;mso-list:l0 level1 lfo2;tab-stops:list .5in'>if they
     are not in their original order, N is not a Jimmy-number. <o:p></o:p></li>
</ul>

<h2><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></h2>

<h2>Input</h2>

<p class=MsoNormal style='text-align:justify'>A maximum of 2000 integer numbers
between 54 and 2000000000 (2 billion), both inclusive, each on a line by it
self, terminated by a –1, which should not be processed.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<h2>Output</h2>

<p class=MsoNormal style='text-align:justify'>For each number in the input one
line of output: &quot;NUMBER is a Jimmy-number&quot; or &quot;NUMBER is not a
Jimmy-number&quot;, whichever appropriate, where NUMBER is replaced by the
input number.<span style='color:black;mso-bidi-font-weight:bold'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='color:black;
mso-bidi-font-weight:bold'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h1 align=left style='text-align:left'><b><span style='font-size:16.0pt;
mso-bidi-font-size:10.0pt;font-family:Arial;font-style:normal'>Sample
Input<span style="mso-spacerun: yes">                           </span>Output
for Sample Input<o:p></o:p></span></b></h1>

<table border=1 cellspacing=0 cellpadding=0 bgcolor="#cccccc" style='background:
 #CCCCCC;border-collapse:collapse;border:none;mso-border-alt:solid windowtext .5pt;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr style='mso-yfti-irow: 0;mso-yfti-lastrow: yes'>
  <td width=295 valign=top style='width:221.4pt;border:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'><pre><b><span style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt'>54<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>101<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>144<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>197<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>1999999973<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>1999999975<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>-1</span></b><b><span
  style='mso-bidi-font-size:12.0pt'><o:p></o:p></span></b></pre></td>
  <td width=321 valign=top style='width:240.85pt;border:solid windowtext .5pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>54 is not a Jimmy-number<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>101 is a Jimmy-number<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>144 is not a Jimmy-number<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>197 is a Jimmy-number<o:p></o:p></span></b></pre><pre><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>1999999973 is a Jimmy-number<o:p></o:p></span></b></pre>
  <p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><b><span
  style='font-size:11.0pt;mso-bidi-font-size:12.0pt;font-family:"Courier New"'>1999999975
  is not a Jimmy-number<o:p></o:p></span></b></p>
  <p class=MsoNormal style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><![if !supportEmptyParas]>&nbsp;<![endif]><b><span
  style='font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New";
  color:black'><o:p></o:p></span></b></p>
  </td>
 </tr>
</table>


<div class=MsoNormal align=center style='text-align:center;tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>

<hr size=2 width="100%" align=center>

</div>


<p class=MsoCaption>Problem setter: Little Joey</p>

</div>

</body>

</html>
