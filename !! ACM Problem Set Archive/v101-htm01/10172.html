<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./p4_files/filelist.xml">
<title>Problem E - 2001 Regionals Warmup Contest</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Rezaul Alam Chowdhury</o:Author>
  <o:LastAuthor>Administrator</o:LastAuthor>
  <o:Revision>18</o:Revision>
  <o:TotalTime>384</o:TotalTime>
  <o:LastPrinted>1999-05-07T21:27:00Z</o:LastPrinted>
  <o:Created>2001-08-25T15:11:00Z</o:Created>
  <o:LastSaved>2001-08-29T03:41:00Z</o:LastSaved>
  <o:Pages>2</o:Pages>
  <o:Words>841</o:Words>
  <o:Characters>4798</o:Characters>
  <o:Company>CSE, BUET</o:Company>
  <o:Lines>39</o:Lines>
  <o:Paragraphs>9</o:Paragraphs>
  <o:CharactersWithSpaces>5892</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>0</w:DisplayVerticalDrawingGridEvery>
  <w:UseMarginsForDrawingGridOrigin/>
  <w:Compatibility>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
  </w:Compatibility>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
h1
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	color:black;
	mso-font-kerning:0pt;}
h2
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:18.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	color:black;
	mso-bidi-font-weight:normal;}
em
	{mso-bidi-font-style:normal;}
p.Preformatted, li.Preformatted, div.Preformatted
	{mso-style-name:Preformatted;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:none;
	tab-stops:0in 47.95pt 95.9pt 143.85pt 191.8pt 239.75pt 287.7pt 335.65pt 383.6pt 431.55pt 479.5pt;
	layout-grid-mode:char;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<p class=MsoNormal align=center style='text-align:center'><b style='mso-bidi-font-weight:
normal'><span style='font-size:18.0pt'>Problem E<o:p></o:p></span></b></p>

<p class=MsoNormal align=center style='text-align:center'><b style='mso-bidi-font-weight:
normal'><span style='font-size:24.0pt'>The Lonesome Cargo Distributor</span><o:p></o:p></b></p>

<p class=MsoNormal align=center style='text-align:center'><b><span
style='mso-bidi-font-size:13.5pt'>Input: </span></b><span style='mso-bidi-font-size:
13.5pt;mso-bidi-font-weight:bold'>standard input<o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center'><b><span
style='mso-bidi-font-size:13.5pt'>Output: </span></b><span style='mso-bidi-font-size:
13.5pt'>standard output<o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center'><b><span
style='mso-bidi-font-size:13.5pt'>Time Limit:</span></b><span style='mso-bidi-font-size:
13.5pt'> 3 seconds<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'>The Plussians believe that the <i
style='mso-bidi-font-style:normal'>Airport Based Cargo Distribution &amp;
Embarkation Facility</i> (<i style='mso-bidi-font-style:normal'>ABCDEF</i> in
short) at the <i style='mso-bidi-font-style:normal'>Cosco International Airport</i>
(<i style='mso-bidi-font-style:normal'>CIA</i>) is the largest such facility in
the whole world though second largest in Plussia. Cargo planes arrive from and
leave for many countries all around the world (Cermany, Q.S.A, Capan, Custralia
etc. are some to name). <i style='mso-bidi-font-style:normal'>ABCDEF</i> is
engaged in distributing, loading and unloading the cargoes carried by these
planes.</p>

<p class=MsoNormal style='text-align:justify'><span style="mso-spacerun:
yes"> </span></p>

<p class=MsoNormal style='text-align:justify'>Each cargo is a cubic box of
fixed size and has a tag attached to it naming the destination country. For
convenience, each country is assigned a unique ID. For example, if there are <i
style='mso-bidi-font-style:normal'>n</i> countries, each country gets a unique
integer ID ranging from 1 to <i style='mso-bidi-font-style:normal'>n</i>.<span
style="mso-spacerun: yes">  </span></p>

<p class=MsoNormal style='text-align:justify;text-indent:.5in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'>Every country <i
style='mso-bidi-font-style:normal'>X</i> has its own <i style='mso-bidi-font-style:
normal'>cargo station</i> identified by its country ID. There are two platforms
(platform <i style='mso-bidi-font-style:normal'>A</i> and platform <i
style='mso-bidi-font-style:normal'>B</i>) in each station. In platform <i
style='mso-bidi-font-style:normal'>A</i> are put those cargoes which are to be
transported (by air) to country <i style='mso-bidi-font-style:normal'>X</i> at
some convenient time. Platform <i style='mso-bidi-font-style:normal'>B</i> is
actually a queue of cargoes which are to be carried to countries other than
country <i style='mso-bidi-font-style:normal'>X</i>. The cargo stations have a
circular (ring) arrangement, that is, if there are <i style='mso-bidi-font-style:
normal'>n</i> stations then each of the following station-pairs are adjacent:
(1, 2), (2, 3), (3, 4), ..., (<i style='mso-bidi-font-style:normal'>n</i> - 1, <i
style='mso-bidi-font-style:normal'>n</i>) and (<i style='mso-bidi-font-style:
normal'>n</i>, 1). </p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'><i style='mso-bidi-font-style:
normal'>ABCDEF</i> has many land-based <i style='mso-bidi-font-style:normal'>cargo
carriers </i>used to carry cargo from station to station. But these carriers
have so narrow space that you cannot even put two cargoes side by side. A
carrier can carry more than one cargo (although there is a limit on the maximum
number of cargoes a carrier can carry) only by putting them (the cargoes) on
top of one another. This stack arrangement has the problem that you cannot just
remove any cargo from the stack as you wish. For example, to remove the 3rd
cargo from the top you must first remove the topmost two cargoes.</p>

<p class=MsoNormal style='text-align:justify;text-indent:.5in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'>A cargo carrier moves from
station to station strictly following their ring arrangement, that is, from
station 1 it moves to station 2, then to 3, then 4, ..., then <i
style='mso-bidi-font-style:normal'>n</i>, then 1 again, etc.. It requires
exactly 2 minutes to move from any station to its adjacent one. </p>

<p class=MsoNormal style='text-align:justify;text-indent:.5in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'>After reaching any station (say,
station <i style='mso-bidi-font-style:normal'>X</i>), the cargo carrier first
attempts to unload cargo. Starting from the topmost cargo in its stack, it
checks the tag attached to the cargo. If it finds that the cargo has
destination <i style='mso-bidi-font-style:normal'>X</i>, then it unloads it
(the cargo) to platform <i style='mso-bidi-font-style:normal'>A</i>, otherwise
it checks to see whether the queue in platform <i style='mso-bidi-font-style:
normal'>B </i>has any vacant position, and if so it puts the cargo at the rear
of the queue. This unloading procedure continues from the top to the bottom of
the stack until one fails or the stack becomes empty, whichever comes first.
Each successful unloading attempt requires exactly 1 minute, that is, unloading
3 cargoes in a station will require exactly 3 minutes. After unloading is
complete, the carrier begins to load. The carrier continues to take the cargo
in front of the queue in platform <i style='mso-bidi-font-style:normal'>B</i>
and put it on top of its stack until the queue is empty or the stack is full,
whichever comes first. Each successful loading attempt also requires exactly 1
minute, that is, loading 4 cargoes from a station will require exactly 4
minutes. After loading is complete, the carrier moves to the next station in
the ring.</p>

<p class=MsoNormal style='text-align:justify;text-indent:.5in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'>In this way, for many years, the
cargo carriers are doing the job of moving the cargoes from platform <i
style='mso-bidi-font-style:normal'>B</i> to platform <i style='mso-bidi-font-style:
normal'>A</i> of appropriate stations from where the cargo planes carry them
(the cargoes) to their destination countries. </p>

<p class=MsoNormal style='text-align:justify;text-indent:.5in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'>But, after a conflict with the
management regarding the pay scale, the employees of <i style='mso-bidi-font-style:
normal'>ABCDEF</i> have gone to a strike for indefinite period from the last
Sunday. Planes are arriving and leaving, but no one is there to load and unload
the cargo. There is no one to distribute the queued cargoes to their
destination stations. The entire facility has now come to a standstill. </p>

<p class=MsoNormal style='text-align:justify;text-indent:.5in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'>But, you, as always known to and
hated by your colleagues as the <i style='mso-bidi-font-style:normal'>boss's
man</i>, have decided to break the strike and save <i style='mso-bidi-font-style:
normal'>CIA</i>. You are going to start working from tomorrow morning and
distribute the queued cargoes to their appropriate stations using a cargo
carrier. Initially your carrier will be empty and, you will start your journey
from station 1 and continue to move around the ring until all the cargoes have
been distributed to their destination stations. But before starting the job,
you have decided to write a program to determine exactly how long it will take
to complete it.</p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h2>Input</h2>

<p class=MsoNormal><span style='font-size:7.0pt;mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'>The input contains several sets
of input. The first line of the input file contains an integer SET, which
indicates how many sets of inputs are there. It is then followed by SET sets of
inputs. In our sample input the value of SET is 2.</p>

<p class=MsoNormal style='text-align:justify'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'>The first line of the input
contains three integers: <i style='mso-bidi-font-style:normal'>N</i>, <i
style='mso-bidi-font-style:normal'>S</i> and <i style='mso-bidi-font-style:
normal'>Q</i>. <i style='mso-bidi-font-style:normal'>N </i>(2 &lt;= <i>N</i> &lt;= 100) is the number of
stations in the ring. <i style='mso-bidi-font-style:normal'>S</i> (1 &lt;= <i>S</i> &lt;= 100) is the capacity of
your cargo carrier, that is, the maximum number of cargoes your carrier can carry.
<i style='mso-bidi-font-style:normal'>Q</i> (1 &lt;= <i>Q</i> &lt;= 100) is the maximum number of cargoes the queue in platform <i
style='mso-bidi-font-style:normal'>B</i> can accommodate. All the queues in the
system are assumed to have the same capacity. </p>

<p class=MsoNormal style='text-align:justify;text-indent:.5in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='text-align:justify'>Then follow <i style='mso-bidi-font-style:
normal'>N</i> lines. Assuming that these lines are numbered from 1 to <i
style='mso-bidi-font-style:normal'>N</i>, for 1 &lt;= <i>i</i> &lt;= <i>N</i>, line <i style='mso-bidi-font-style:
normal'>i</i> contains an integer <i style='mso-bidi-font-style:normal'><span
style='color:windowtext'>Q<sub>i</sub></span></i> (0 &lt;= <i style='mso-bidi-font-style:
normal'><span style='color:windowtext'>Q<sub>i</sub></span></i> &lt;= <i
style='mso-bidi-font-style:normal'>Q</i>) giving the number of cargoes queued
at station <i style='mso-bidi-font-style:normal'>i</i> followed by <i
style='mso-bidi-font-style:normal'><span style='color:windowtext'>Q<sub>i</sub></span></i><sub><span
style='color:windowtext'> </span></sub>integers giving the destination stations
of the queued cargoes from front to rear. You may assume that none of these <i
style='mso-bidi-font-style:normal'><span style='color:windowtext'>Q<sub>i</sub></span></i><sub><span
style='color:windowtext'> </span></sub>cargoes will have station <i
style='mso-bidi-font-style:normal'>i</i> as their destination. </p>

<p class=MsoNormal style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='font-size:14.0pt;mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<h2>Output</h2>

<p class=MsoNormal style='text-align:justify'><span style='font-size:7.0pt;
mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'>For each set of input output the
number of minutes it will take to finish the job in a separate line. </p>

<p class=MsoNormal style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='font-size:14.0pt;mso-bidi-font-size:10.0pt'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<h2>Sample Input</h2>
<font size=3 face="Courier, Arial, Times New Roman, Helvetica">
2<br>

5 2 3<br>

3 4 5 2<br>

2 1 3<br>

0<br>

3 3 5 1<br>

1 4<br>

5 2 3<br>

3 4 5 2<br>

2 1 3<br>

0<br>

3 3 5 1<br>

1 4<br>
</font>
<br>
<h2>Sample Output</h2>
<font size=3 face="Courier, Arial, Times New Roman, Helvetica">

72<br>

72<br>

</div>
</font>
<hr>
<h1>Rezaul Alam Chowdhury</h1>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal align=center style='text-align:center'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal align=center style='text-align:center'>“All good things must
come to an end.”</p>

</div>

</body>

</html>
