<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 10">
<meta name=Originator content="Microsoft Word 10">
<link rel=File-List href="g_files/filelist.xml">
<link rel=Edit-Time-Data href="g_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Problem G -Toll! Revisited</title>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="City"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="place"/>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Shahriar Manzoor</o:Author>
  <o:LastAuthor>Shahriar Manzoor</o:LastAuthor>
  <o:Revision>209</o:Revision>
  <o:TotalTime>1212</o:TotalTime>
  <o:LastPrinted>2002-10-30T12:22:00Z</o:LastPrinted>
  <o:Created>2002-02-22T05:31:00Z</o:Created>
  <o:LastSaved>2003-07-25T05:11:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>508</o:Words>
  <o:Characters>2896</o:Characters>
  <o:Company>CSE, BUET</o:Company>
  <o:Lines>24</o:Lines>
  <o:Paragraphs>6</o:Paragraphs>
  <o:CharactersWithSpaces>3398</o:CharactersWithSpaces>
  <o:Version>10.3501</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:View>Print</w:View>
  <w:Zoom>BestFit</w:Zoom>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>0</w:DisplayVerticalDrawingGridEvery>
  <w:UseMarginsForDrawingGridOrigin/>
  <w:Compatibility>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if !mso]><object
 classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Courier;
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:0;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:135 0 0 0 27 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
h1
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-outline-level:1;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	color:black;
	mso-font-kerning:0pt;
	font-weight:normal;
	font-style:italic;}
h2
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	mso-outline-level:2;
	tab-stops:143.25pt;
	font-size:18.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	color:black;
	mso-bidi-font-weight:normal;}
h3
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:14.0pt;
	font-family:Arial;
	mso-font-kerning:14.0pt;
	mso-fareast-language:ZH-CN;
	font-weight:normal;}
h4
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:12.0pt;
	font-family:Arial;
	mso-fareast-language:ZH-CN;}
h5
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:5;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:11.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Courier New";
	color:black;}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;
	font-weight:bold;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyText2, li.MsoBodyText2, div.MsoBodyText2
	{margin:0in;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;
	mso-bidi-font-weight:bold;}
a:link, span.MsoHyperlink
	{color:#6633CC;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
em
	{mso-bidi-font-style:normal;}
pre
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Courier New";}
p.Preformatted, li.Preformatted, div.Preformatted
	{mso-style-name:Preformatted;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:none;
	tab-stops:0in 47.95pt 95.9pt 143.85pt 191.8pt 239.75pt 287.7pt 335.65pt 383.6pt 431.55pt 479.5pt;
	layout-grid-mode:char;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.IOSample, li.IOSample, div.IOSample
	{mso-style-name:IOSample;
	mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:Courier;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	mso-fareast-language:ZH-CN;}
span.StyleArial16pt
	{mso-style-name:"Style Arial 16 pt";
	mso-ansi-font-size:16.0pt;
	font-family:Arial;
	mso-ascii-font-family:Arial;
	mso-hansi-font-family:Arial;
	mso-bidi-font-family:Arial;
	font-weight:bold;}
@page Section1
	{size:595.45pt 841.7pt;
	margin:1.0in 1.0in 1.0in 1.0in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US link="#6633CC" vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<h1 align=center style='text-align:center;tab-stops:4.0in'><b><span
style='font-size:28.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;font-style:
normal'>Problem G<o:p></o:p></span></b></h1>

<h2 align=center style='text-align:center'><span style='font-size:20.0pt;
mso-bidi-font-size:10.0pt;font-family:Arial'>Toll! Revisited<o:p></o:p></span></h2>

<h3><b><span style='font-size:12.0pt;mso-bidi-font-size:14.0pt'>Input:</span></b><span
style='font-size:12.0pt;mso-bidi-font-size:14.0pt'> Standard Input<o:p></o:p></span></h3>

<p class=MsoNormal align=center style='text-align:center'><b><span
style='font-family:Arial;mso-fareast-language:ZH-CN'>Output:</span></b><span
style='font-family:Arial;mso-fareast-language:ZH-CN'> Standard Output</span><span
style='font-family:Arial;mso-bidi-font-weight:bold'> <o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center'><b style='mso-bidi-font-weight:
normal'><span style='font-family:Arial'>Time Limit: </span></b><span
style='font-family:Arial;mso-bidi-font-weight:bold'>1 Second</span><span
style='mso-fareast-language:ZH-CN'><o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Sindbad the Sailor sold <b
style='mso-bidi-font-weight:normal'>66</b> silver spoons to the Sultan of
Samarkand. The selling was quite easy; but delivering was complicated. The
items were transported over land, passing through several towns and villages.
Each town and village demanded an entry toll. There were no tolls for leaving.
The toll for entering a <span style='mso-bidi-font-style:italic'>village</span>
was simply one item. The toll for entering a <i>town</i> was one piece per <b
style='mso-bidi-font-weight:normal'>20</b> items carried. For example, to enter
a town carrying<i style='mso-bidi-font-style:normal'> </i><b style='mso-bidi-font-weight:
normal'>70</b> items, you had to pay <b style='mso-bidi-font-weight:normal'>4</b>
items as toll. The towns and villages were situated strategically between
rocks, swamps and rivers, so you could not avoid them.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<div align=center>
<center>
<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;mso-table-layout-alt:fixed;mso-padding-alt:
 0in 5.4pt 0in 5.4pt'>
 <tr style='mso-yfti-irow:0'>
  <td width=634 valign=top style='width:6.6in;padding:0in 5.4pt 0in 5.4pt'>
<center><img width=307 height=88
  src="p10537a.jpg"></center>

  </td>
 </tr>
 <tr style='mso-yfti-irow:1;mso-yfti-lastrow:yes'>
  <td width=634 valign=top style='width:6.6in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'>Figure 1: To reach <st1:City><st1:place>Samarkand</st1:place></st1:City>
  with <b style='mso-bidi-font-weight:normal'>66</b> spoons, traveling through
  a town followed by two villages, you must start with <b style='mso-bidi-font-weight:
  normal'>76</b> spoons.</p>
  </td>
 </tr>
</table>
</center>
</div>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<div align=center>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;mso-table-layout-alt:fixed;mso-padding-alt:
 0in 5.4pt 0in 5.4pt'>
 <tr style='mso-yfti-irow:0'>
  <td width=319 valign=top style='width:239.4pt;padding:0in 5.4pt 0in 5.4pt'>
     <img width=286 height=208
  src="p10537b.jpg">
  </td>  
 
  </td>
  <td width=319 valign=top style='width:239.4pt;padding:0in 5.4pt 0in 5.4pt'>
   <img width=287 height=205 src="p10537c.jpg">
  
  </td>
 </tr>
 <tr style='mso-yfti-irow:1;mso-yfti-lastrow:yes'>
  <td width=638 colspan=2 valign=top style='width:6.65in;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'>Figure 2: The best route to
  reach <b style='mso-bidi-font-weight:normal'>X</b> with <b style='mso-bidi-font-weight:
  normal'>39</b> spoons, starting from <b style='mso-bidi-font-weight:normal'>A</b>,
  is <b style='mso-bidi-font-weight:normal'>A-&gt;b-&gt;c-&gt;X</b>, shown with
  arrows in the figure on the left. The best route to reach <b
  style='mso-bidi-font-weight:normal'>X</b> with <b style='mso-bidi-font-weight:
  normal'>10</b> spoons is <b style='mso-bidi-font-weight:normal'>A-&gt;D-&gt;X</b>,
  shown in the figure on the right. The figures display towns as squares and
  villages as circles.</p>
  </td>
 </tr>
</table>

</div>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoBodyText style='text-align:justify'>Predicting the tolls charged in
each village or town is quite simple, but finding the best route (the cheapest
route) is a real challenge. The best route depends upon the number of items
carried. For numbers up to <b style='mso-bidi-font-weight:normal'>20</b>,
villages and towns charge the same. For large numbers of items, it makes sense
to avoid towns and travel through more villages, as illustrated in Figure <b
style='mso-bidi-font-weight:normal'>2</b>.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoBodyText2><span style='mso-bidi-font-weight:normal'>You must write
a program to solve Sindbad’s problem. Given the number of items to be delivered
to a certain town or village and a road map, your program must determine the
total number of items required at the beginning of the journey that uses a
cheapest route. You will also have to find the cheapest route. If there is more
than one such route, print the lexicographically smallest one (<b
style='mso-bidi-font-weight:normal'>A-n-d</b> is smaller than <b
style='mso-bidi-font-weight:normal'>a-n-d</b>).<o:p></o:p></span></p>

<b><span style='font-size:12.0pt;font-family:Arial;mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-US;mso-fareast-language:ZH-CN;
mso-bidi-language:AR-SA'><br clear=all style='page-break-before:always'>
</span></b>

<h4><span style='font-size:16.0pt;mso-bidi-font-size:12.0pt'>Input<o:p></o:p></span></h4>

<p class=MsoNormal style='text-align:justify'>The input consists of several test
cases. Each test case consists of two parts: the roadmap followed by the
delivery details. </p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The first line of the roadmap
contains an integer <b style='mso-bidi-font-weight:normal'>n</b>, which is the
number of roads in the map <b style='mso-bidi-font-weight:normal'>(0 &lt;= <i
style='mso-bidi-font-style:normal'>n</i>)</b>. Each of the next <b
style='mso-bidi-font-weight:normal'>n</b> lines contains exactly two letters representing
the two endpoints of a road. A capital letter represents a town; a lower case
letter represents a village. Roads can be traveled in either direction.</p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>Following the roadmap is a single
line for the delivery details. This line consists of three things: an integer <b
style='mso-bidi-font-weight:normal'>p (0 &lt; p &lt; 1000000000)</b> for the
number of items that must be delivered, a letter for the starting place, and a
letter for the place of delivery. The roadmap is always such that the items can
be delivered.<i style='mso-bidi-font-style:normal'><o:p></o:p></i></p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'>The last test case is followed by
a line containing the number -1. </p>

<p class=MsoNormal style='text-align:justify'>&nbsp;</p>

<h4><span style='font-size:16.0pt;mso-bidi-font-size:12.0pt'>Output <o:p></o:p></span></h4>

<p class=MsoNormal style='margin-top:6.0pt;text-align:justify'>The output
consists of three lines for each test case. First line displays the case
number, second line shows the number of items required at the beginning of the
journey and third line shows the path according to the problem statement above.
Actually, the path contains all the city/village names that Sindbad sees along
his journey. Two consecutive city/village names in the path are separated by a
hyphen. </p>

<h1 align=left style='text-align:left'><span style='font-size:16.0pt;
mso-bidi-font-size:10.0pt;font-family:Arial'>&nbsp;<o:p></o:p></span></h1>

<h1 align=left style='text-align:left'><b><span style='font-size:16.0pt;
mso-bidi-font-size:10.0pt;font-family:Arial;font-style:normal'>Sample
Input<span style='mso-spacerun:yes'>                             </span>Output
for Sample Input<o:p></o:p></span></b></h1>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0
 style='background:#CCCCCC;border-collapse:collapse;border:none;mso-border-alt:
 solid windowtext .5pt;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr style='mso-yfti-irow:0;mso-yfti-lastrow:yes'>
  <td width=307 valign=top style='width:3.2in;border:solid windowtext 1.0pt;
  mso-border-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=IOSample style='margin-top:1.0pt'><b><span style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;font-family:"Courier New"'>1<o:p></o:p></span></b></p>
  <p class=IOSample><b><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  font-family:"Courier New"'>a Z<o:p></o:p></span></b></p>
  <p class=IOSample><b><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  font-family:"Courier New"'>19 a Z<o:p></o:p></span></b></p>
  <p class=IOSample><b><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  font-family:"Courier New"'>5<o:p></o:p></span></b></p>
  <p class=IOSample><b><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  font-family:"Courier New"'>A D<o:p></o:p></span></b></p>
  <p class=IOSample><b><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  font-family:"Courier New"'>D X<o:p></o:p></span></b></p>
  <p class=IOSample><b><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  font-family:"Courier New"'>A b<o:p></o:p></span></b></p>
  <p class=IOSample><b><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  font-family:"Courier New"'>b c<o:p></o:p></span></b></p>
  <p class=IOSample><b><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  font-family:"Courier New"'>c X<o:p></o:p></span></b></p>
  <p class=IOSample><b><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt;
  font-family:"Courier New"'>39 A X<o:p></o:p></span></b></p>
  <pre><b><span style='font-size:11.0pt;mso-bidi-font-size:10.0pt'>-1</span></b><b><span
  style='mso-bidi-font-size:12.0pt'><o:p></o:p></span></b></pre></td>
  <td width=309 valign=top style='width:231.85pt;border:solid windowtext 1.0pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;mso-border-alt:
  solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=IOSample style='margin-top:1.0pt'><b><span style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;font-family:"Courier New"'>Case 1: <o:p></o:p></span></b></p>
  <p class=IOSample style='margin-top:1.0pt'><b><span style='font-size:11.0pt;
  mso-bidi-font-size:10.0pt;font-family:"Courier New"'>20<o:p></o:p></span></b></p>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span
  style='font-family:"Courier New";mso-fareast-language:ZH-CN'>a-Z<o:p></o:p></span></b></p>
  <h5>Case 2:</h5>
  <h5>44</h5>
  <p class=MsoNormal><b style='mso-bidi-font-weight:normal'>A-b-c-X<o:p></o:p></b></p>
  </td>
 </tr>
</table>

<div class=MsoNormal align=center style='text-align:center'><span lang=EN
style='mso-ansi-language:EN'>

<hr size=2 width="100%" align=center>

</span></div>

<p class=MsoNormal style='text-align:justify'><b><span style='mso-bidi-font-size:
14.0pt'>Orignal Problem: ACM ICPC World Finals 2003, Enhanced by SM, Member of
EPP</span></b></p>

</div>

</body>

</html>
