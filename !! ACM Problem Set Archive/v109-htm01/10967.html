<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">

<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Problem D</title>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="PlaceType"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="PlaceName"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="place"/>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Arash Rahimi</o:Author>
  <o:LastAuthor>Arash Rahimi</o:LastAuthor>
  <o:Revision>3</o:Revision>
  <o:TotalTime>236</o:TotalTime>
  <o:Created>2005-11-07T20:14:00Z</o:Created>
  <o:LastSaved>2005-11-07T20:14:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>801</o:Words>
  <o:Characters>4568</o:Characters>
  <o:Company>Home</o:Company>
  <o:Lines>38</o:Lines>
  <o:Paragraphs>10</o:Paragraphs>
  <o:CharactersWithSpaces>5359</o:CharactersWithSpaces>
  <o:Version>11.5606</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:GrammarState>Clean</w:GrammarState>
  <w:PunctuationKerning/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]--><!--[if !mso]><object
 classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
<!--[if gte mso 9]>
<xml><o:shapedefaults v:ext="edit" spidmax="1027"/>
</xml><![endif]-->
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<p class=MsoNormal style='margin-top:6.0pt;margin-right:0in;margin-bottom:6.0pt;
margin-left:0in'><b><span style='font-size:14.0pt'>Problem D<o:p></o:p></span></b></p>

<p class=MsoNormal align=center style='margin-top:6.0pt;margin-right:0in;
margin-bottom:6.0pt;margin-left:0in;text-align:center'><b><span
style='font-size:14.0pt'>The Great Escape<o:p></o:p></span></b></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt'>Poor
Kianoosh! 6 weeks since he was officially accepted as a citizen of Barareh and
during this time he has had nothing but Nochophskew for his breakfast, lunch
and dinner. And nowadays, during the nights, he dreams of nothing but a small
piece of bread, some cheese and a glass of milk to have for his breakfast. And
during the days, he thinks of nothing but a great escape from this weird city
in order to turn his night-time dreams into reality.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt'>After
carefully checking all the potential ways out of the city, he concluded that
there are only three such possible ways. The first one is through the city gate
which is of course guarded by fully-armed guards, ready to kill any creature
trying to go through the gate without permission. The second way is passing
through the northern walls of the city and going through a jungle which
contains nothing but those deadly snakes called NeshimanGazes (And be sure that
Kianoosh does not like to repeat his creepy experience with them again).<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt'>Finally,
the third and the last (and of course the only feasible) way is passing through
a secret door in the famous so called <st1:place w:st="on"><st1:PlaceName
 w:st="on">HezarDaroon</st1:PlaceName> <st1:PlaceType w:st="on">Castle</st1:PlaceType></st1:place>
(means a castle with thousands of doors). Unfortunately, the problem with this
castle is that no one actually knows the way to reach this secret door.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt'>After
spending some time gathering information about the castle, Kianoosh found out
that HezarDaroon can actually be modeled as an <sub><!--[if gte vml 1]><v:shapetype id="_x0000_t75"
 coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe"
 filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_s1047" type="#_x0000_t75" style='width:27.75pt;
 height:11.25pt'>
 <v:imagedata src="images/p3_files/image001.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=37 height=15
src="p10967a.gif" v:shapes="_x0000_s1047"><![endif]></sub><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="_x0000_i1025"
  DrawAspect="Content" ObjectID="_1192912257">
 </o:OLEObject>
</xml><![endif]--><span style='mso-spacerun:yes'> </span>grid with each cell
representing a room in the castle. There is always a door between two
neighboring rooms but there are some rooms which contain a NeshimanGaz ready to
serve anyone trying to enter the room with its poisonous bites.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt'>There
are also some rooms which contain a rotating door. A rotating door is actually a
cylinder positioned at the center of the room with a slice removed from it. In
Figure 1, you can see a room with a rotating door with its removed slice facing
towards west.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:10.0pt'><!--[if gte vml 1]><v:shape
 id="_x0000_s1046" type="#_x0000_t75" style='width:194.25pt;height:141pt'>
 <v:imagedata src="images/p3_files/image003.gif" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=259 height=188
src="p10967b.gif" v:shapes="_x0000_s1046"><![endif]><o:p></o:p></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal align=center style='text-align:center'><span class=GramE><b><span
style='font-size:10.0pt'>Figure 1. A Rotating Door</span></b></span><span style='font-size:
10.0pt'> <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt'>As
it can be seen, one can only enter the room from the neighbor to which the
removed slice is facing. And once Kianoosh enters the room, he can rotate the
door clockwise or counter-clockwise in order to reach the other doors in the
room. For example, in the configuration of figure 1, if he rotates the door
clockwise by 90 degrees, he can reach the door to the north and if he continues
rotating the door by another 90 degrees in the same direction, he can reach the
door to east. <o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt'>Another
important fact about the rotating doors is that associated to each door is a
number <sub><!--[if gte vml 1]><v:shape
 id="_x0000_s1045" type="#_x0000_t75" style='width:11.25pt;height:14.25pt'>
 <v:imagedata src="images/p3_files/image005.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=15 height=19
src="p10967c.gif" v:shapes="_x0000_s1045"><![endif]></sub><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="_x0000_i1027"
  DrawAspect="Content" ObjectID="_1192912259">
 </o:OLEObject>
</xml><![endif]--><span style='mso-spacerun:yes'> </span>which is the amount of
time, measured in seconds, that it takes for a normal human-being(like
Kianoosh) to rotate the door by 90 degrees. You may also assume that going from
a room to its neighbor room takes exactly 1 second.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt'>Today,
after spending a noticeable amount of money, Kianoosh managed to buy a map of
the castle from underground shops of Barareh. Taking a look at the map, he
found that the entrance to the castle is located at the lower-left corner and
the secret door is located at the upper-right corner of the grid. He can also
see the position and the initial configuration of the rotating doors and the
coordinates of rooms containing the deadly NeshimanGazes to which Kianoosh does
not like to enter.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt'>Kianoosh
is happy. He is only one step away from his dreams coming true. But how can he
find his way to the secret door? Yes! He needs help! And as a genius
problem-solver, you should help him find the path with the minimum required
time to reach the secret passage from the lower-left corner of the castle.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-top:6.0pt;margin-right:0in;margin-bottom:6.0pt;
margin-left:0in;text-align:justify'><b style='mso-bidi-font-weight:normal'><o:p>&nbsp;</o:p></b></p>

<p class=MsoNormal style='margin-top:6.0pt;margin-right:0in;margin-bottom:6.0pt;
margin-left:0in;text-align:justify'><b style='mso-bidi-font-weight:normal'>The Input
<o:p></o:p></b></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt'>The
first line of the input contains an integer <sub><!--[if gte vml 1]><v:shape
 id="_x0000_s1044" type="#_x0000_t75" style='width:33.75pt;height:12pt'>
 <v:imagedata src="images/p3_files/image007.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=45 height=16
src="p10967d.gif" v:shapes="_x0000_s1044"><![endif]></sub><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="_x0000_i1028"
  DrawAspect="Content" ObjectID="_1192912260">
 </o:OLEObject>
</xml><![endif]--><span style='mso-spacerun:yes'> </span>which is the number of
test cases. Each test case begins with a line containing <sub><!--[if gte vml 1]><v:shape
 id="_x0000_s1043" type="#_x0000_t75" style='width:50.25pt;height:12pt'>
 <v:imagedata src="images/p3_files/image009.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=67 height=16
src="p10967e.gif" v:shapes="_x0000_s1043"><![endif]></sub><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="_x0000_i1029"
  DrawAspect="Content" ObjectID="_1192912261">
 </o:OLEObject>
</xml><![endif]-->(the number of rows) and <sub><!--[if gte vml 1]><v:shape
 id="_x0000_s1042" type="#_x0000_t75" style='width:45pt;height:12pt'>
 <v:imagedata src="images/p3_files/image011.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=60 height=16
src="p10967f.gif" v:shapes="_x0000_s1042"><![endif]></sub><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="_x0000_i1030"
  DrawAspect="Content" ObjectID="_1192912262">
 </o:OLEObject>
</xml><![endif]-->(the number of columns) followed by <sub><!--[if gte vml 1]><v:shape
 id="_x0000_s1041" type="#_x0000_t75" style='width:11.25pt;height:9.75pt'>
 <v:imagedata src="images/p3_files/image013.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=15 height=13
src="ip10967g.gif" v:shapes="_x0000_s1041"><![endif]></sub><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="_x0000_i1031"
  DrawAspect="Content" ObjectID="_1192912263">
 </o:OLEObject>
</xml><![endif]--><span style='mso-spacerun:yes'> </span>lines, with the <sub><!--[if gte vml 1]><v:shape
 id="_x0000_s1040" type="#_x0000_t75" style='width:6.75pt;height:12pt'>
 <v:imagedata src="images/p3_files/image015.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=9 height=16
src="p10967h.gif" v:shapes="_x0000_s1040"><![endif]></sub><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="_x0000_i1032"
  DrawAspect="Content" ObjectID="_1192912264">
 </o:OLEObject>
</xml><![endif]-->th line containing <sub><!--[if gte vml 1]><v:shape
 id="_x0000_s1039" type="#_x0000_t75" style='width:9pt;height:9.75pt'>
 <v:imagedata src="images/p3_files/image017.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=12 height=13
src="p10967i.gif" v:shapes="_x0000_s1039"><![endif]></sub><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="_x0000_i1033"
  DrawAspect="Content" ObjectID="_1192912265">
 </o:OLEObject>
</xml><![endif]--><span style='mso-spacerun:yes'> </span>characters, the <sub><!--[if gte vml 1]><v:shape
 id="_x0000_s1038" type="#_x0000_t75" style='width:9pt;height:14.25pt'>
 <v:imagedata src="images/p3_files/image019.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=12 height=19
src="p10967j.gif" v:shapes="_x0000_s1038"><![endif]></sub><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="_x0000_i1034"
  DrawAspect="Content" ObjectID="_1192912266">
 </o:OLEObject>
</xml><![endif]-->th character of which representing the status of the <sub><!--[if gte vml 1]><v:shape
 id="_x0000_s1037" type="#_x0000_t75" style='width:9pt;height:14.25pt'>
 <v:imagedata src="images/p3_files/image019.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=12 height=19
src="p10967j.gif" v:shapes="_x0000_s1037"><![endif]></sub><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="_x0000_i1035"
  DrawAspect="Content" ObjectID="_1192912267">
 </o:OLEObject>
</xml><![endif]-->th cell in the <sub><!--[if gte vml 1]><v:shape
 id="_x0000_s1036" type="#_x0000_t75" style='width:6.75pt;height:12pt'>
 <v:imagedata src="images/p3_files/image021.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=9 height=16
src="p10967h.gif" v:shapes="_x0000_s1036"><![endif]></sub><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="_x0000_i1036"
  DrawAspect="Content" ObjectID="_1192912268">
 </o:OLEObject>
</xml><![endif]-->th row of the grid (counted from north). Each character may
have six different values. A ‘</span><span style='font-size:10.0pt;font-family:
"Courier New"'>.</span><span style='font-size:10.0pt'>’ character represents a
normal room while a ‘</span><span style='font-size:10.0pt;font-family:"Courier New"'>#</span><span
style='font-size:10.0pt'>’ represents a room containing a NeshimanGaz and ‘</span><span
style='font-size:10.0pt;font-family:"Courier New"'>N</span><span
style='font-size:10.0pt'>’, ‘</span><span style='font-size:10.0pt;font-family:
"Courier New"'>W</span><span style='font-size:10.0pt'>’, ‘</span><span
style='font-size:10.0pt;font-family:"Courier New"'>E</span><span
style='font-size:10.0pt'>’, ‘</span><span style='font-size:10.0pt;font-family:
"Courier New"'>S</span><span style='font-size:10.0pt'>’ represent a room with a
rotating door facing north, west, east, and south respectively. The map is
followed by <sub><!--[if gte vml 1]><v:shape
 id="_x0000_s1035" type="#_x0000_t75" style='width:12pt;height:11.25pt'>
 <v:imagedata src="images/p3_files/image022.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=16 height=15
src="p10967k.gif" v:shapes="_x0000_s1035"><![endif]></sub><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="_x0000_i1037"
  DrawAspect="Content" ObjectID="_1192912269">
 </o:OLEObject>
</xml><![endif]--><span style='mso-spacerun:yes'> </span>integers, the <sub><!--[if gte vml 1]><v:shape
 id="_x0000_s1034" type="#_x0000_t75" style='width:9pt;height:12.75pt'>
 <v:imagedata src="images/p3_files/image024.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=12 height=17
src="p10967l.gif" v:shapes="_x0000_s1034"><![endif]></sub><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="_x0000_i1038"
  DrawAspect="Content" ObjectID="_1192912270">
 </o:OLEObject>
</xml><![endif]--><span class=GramE>th</span> of which is equal to <sub><!--[if gte vml 1]><v:shape
 id="_x0000_s1033" type="#_x0000_t75" style='width:14.25pt;height:15pt'>
 <v:imagedata src="images/p3_files/image026.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=19 height=20
src="p10967m.gif" v:shapes="_x0000_s1033"><![endif]></sub><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="_x0000_i1039"
  DrawAspect="Content" ObjectID="_1192912271">
 </o:OLEObject>
</xml><![endif]--><span style='mso-spacerun:yes'> </span>for the <sub><!--[if gte vml 1]><v:shape
 id="_x0000_s1032" type="#_x0000_t75" style='width:9pt;height:12.75pt'>
 <v:imagedata src="images/p3_files/image028.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=12 height=17
src="p10967l.gif" v:shapes="_x0000_s1032"><![endif]></sub><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="_x0000_i1040"
  DrawAspect="Content" ObjectID="_1192912272">
 </o:OLEObject>
</xml><![endif]-->th door, counting the doors from the north-west corner in a
row major order. You can assume that <sub><!--[if gte vml 1]><v:shape
 id="_x0000_s1031" type="#_x0000_t75" style='width:12pt;height:11.25pt'>
 <v:imagedata src="images/p3_files/image022.wmz" o:title=""/>
</v:shape><![endif]--><![if !vml]><img border=0 width=16 height=15
src="p10967k.gif" v:shapes="_x0000_s1031"><![endif]></sub><!--[if gte mso 9]><xml>
 <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="_x0000_i1041"
  DrawAspect="Content" ObjectID="_1192912273">
 </o:OLEObject>
</xml><![endif]-->(which is the number of rotating doors in the castle) is no
more than 500, and the entrance (room at lower-left corner) and the room
containing the secret door (room at upper-right corner) does not contain
NeshimanGazes or rotating doors.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-top:6.0pt;margin-right:0in;margin-bottom:6.0pt;
margin-left:0in;text-align:justify'><b style='mso-bidi-font-weight:normal'>The Output
<o:p></o:p></b></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt'>For
each test case, your program should output a line containing a single integer
which is the minimum amount of time required for Kianoosh to reach the secret
door. In the case the secret door is not reachable with respect to the given
map and rules, a line containing the phrase “</span><span style='font-size:
10.0pt;font-family:"Courier New"'>Poor Kianoosh</span><span style='font-size:
10.0pt'>” should be printed.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><o:p>&nbsp;</o:p></p>

<p class=MsoNormal style='margin-top:6.0pt;margin-right:0in;margin-bottom:6.0pt;
margin-left:0in;text-align:justify'><b>Sample Input<o:p></o:p></b></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Courier New"'>1<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Courier New"'>3 3<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Courier New"'>.#.<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Courier New"'>..W<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Courier New"'>...<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Courier New"'>10<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-align:justify'><b>Sample Output<o:p></o:p></b></p>

<p class=MsoNormal style='text-align:justify'><span style='font-size:10.0pt;
font-family:"Courier New"'>14<o:p></o:p></span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

</div>

<hr size=2 width="100%" align=center>

<p class=MsoNormal style='text-align:justify'><b><span style='color:black'>
Amirkabir University of Technology - Local Contest - Round #2
</span></b><span
style='color:black'><o:p></o:p></span></p>

</body>

</html>
